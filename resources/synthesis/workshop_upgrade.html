<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <link rel="stylesheet" type="text/css" href="../common/common.css">
    <link rel="stylesheet" type="text/css" href="./workshop_upgrade.css">
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="workshop-logo">ğŸ­âš¡</div>
            <div class="title">å·¥åŠå‡çº§</div>
            <div class="subtitle">Workshop Upgrade - æå‡ä½ çš„åˆæˆèƒ½åŠ›</div>
        </div>
        
        <div class="current-workshop">
            <div class="workshop-overview">
                <div class="workshop-image">
                    <img src="{{workshopImage}}" alt="å·¥åŠ">
                    <div class="workshop-level-badge">Lv.{{currentLevel}}</div>
                </div>
                
                <div class="workshop-info">
                    <div class="workshop-name">{{workshopName}}</div>
                    <div class="workshop-description">{{workshopDescription}}</div>
                    
                    <div class="workshop-stats">
                        <div class="stat-row">
                            <div class="stat-item">
                                <span class="stat-icon">âš¡</span>
                                <span class="stat-label">åˆæˆæ•ˆç‡:</span>
                                <span class="stat-value">{{synthesisEfficiency}}%</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-icon">âœ¨</span>
                                <span class="stat-label">æˆåŠŸç‡åŠ æˆ:</span>
                                <span class="stat-value">+{{successRateBonus}}%</span>
                            </div>
                        </div>
                        
                        <div class="stat-row">
                            <div class="stat-item">
                                <span class="stat-icon">ğŸ”§</span>
                                <span class="stat-label">å¯ç”¨å·¥ä½œå°:</span>
                                <span class="stat-value">{{availableWorkbenches}}</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-icon">ğŸ“¦</span>
                                <span class="stat-label">æ‰¹é‡åˆæˆ:</span>
                                <span class="stat-value">{{batchSynthesisLimit}}</span>
                            </div>
                        </div>
                        
                        <div class="stat-row">
                            <div class="stat-item">
                                <span class="stat-icon">ğŸ’</span>
                                <span class="stat-label">ç¨€æœ‰ææ–™åŠ æˆ:</span>
                                <span class="stat-value">+{{rareMaterialBonus}}%</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-icon">â±ï¸</span>
                                <span class="stat-label">åˆæˆæ—¶é—´:</span>
                                <span class="stat-value">-{{timeReduction}}%</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="workshop-features">
                <div class="features-title">ğŸŒŸ å½“å‰ç‰¹æ€§</div>
                <div class="features-grid">
                    {{#each currentFeatures}}
                    <div class="feature-item {{rarity}}">
                        <div class="feature-icon">{{icon}}</div>
                        <div class="feature-info">
                            <div class="feature-name">{{name}}</div>
                            <div class="feature-desc">{{description}}</div>
                        </div>
                        <div class="feature-level">Lv.{{level}}</div>
                    </div>
                    {{/each}}
                </div>
            </div>
        </div>

        <div class="upgrade-options">
            <div class="upgrade-header">
                <div class="upgrade-title">ğŸš€ å‡çº§é€‰é¡¹</div>
                <div class="player-resources">
                    <div class="resource-item">
                        <span class="resource-icon">ğŸ’°</span>
                        <span class="resource-amount">{{playerMoney}}</span>
                    </div>
                    <div class="resource-item">
                        <span class="resource-icon">ğŸ’</span>
                        <span class="resource-amount">{{playerGems}}</span>
                    </div>
                    <div class="resource-item">
                        <span class="resource-icon">ğŸ”§</span>
                        <span class="resource-amount">{{playerMaterials}}</span>
                    </div>
                </div>
            </div>
            
            <div class="upgrade-tabs">
                <div class="upgrade-tab active" data-type="level">ç­‰çº§å‡çº§</div>
                <div class="upgrade-tab" data-type="feature">ç‰¹æ€§å‡çº§</div>
                <div class="upgrade-tab" data-type="expansion">å·¥åŠæ‰©å»º</div>
            </div>
            
            <div class="upgrade-content">
                <!-- ç­‰çº§å‡çº§ -->
                <div class="upgrade-section level-upgrade active">
                    {{#if canLevelUp}}
                    <div class="next-level-preview">
                        <div class="preview-header">
                            <div class="preview-title">å‡çº§åˆ° Lv.{{nextLevel}}</div>
                            <div class="preview-subtitle">è§£é”æ›´å¼ºå¤§çš„åˆæˆèƒ½åŠ›</div>
                        </div>
                        
                        <div class="preview-comparison">
                            <div class="comparison-section">
                                <div class="comparison-title">å±æ€§æå‡</div>
                                <div class="comparison-stats">
                                    {{#each statUpgrades}}
                                    <div class="stat-upgrade">
                                        <span class="stat-name">{{name}}:</span>
                                        <span class="stat-current">{{currentValue}}</span>
                                        <span class="stat-arrow">â†’</span>
                                        <span class="stat-new">{{newValue}}</span>
                                        <span class="stat-change">(+{{change}})</span>
                                    </div>
                                    {{/each}}
                                </div>
                            </div>
                            
                            <div class="comparison-section">
                                <div class="comparison-title">æ–°å¢ç‰¹æ€§</div>
                                <div class="new-features">
                                    {{#each newFeatures}}
                                    <div class="new-feature">
                                        <span class="feature-icon">{{icon}}</span>
                                        <span class="feature-name">{{name}}</span>
                                        <span class="feature-desc">{{description}}</span>
                                    </div>
                                    {{/each}}
                                </div>
                            </div>
                        </div>
                        
                        <div class="upgrade-cost">
                            <div class="cost-title">å‡çº§è´¹ç”¨</div>
                            <div class="cost-items">
                                {{#each levelUpgradeCost}}
                                <div class="cost-item {{#unless canAfford}}insufficient{{/unless}}">
                                    <span class="cost-icon">{{icon}}</span>
                                    <span class="cost-amount">{{amount}}</span>
                                    <span class="cost-type">{{type}}</span>
                                </div>
                                {{/each}}
                            </div>
                        </div>
                        
                        <div class="upgrade-actions">
                            <button class="upgrade-btn level-upgrade-btn" {{#unless canAffordLevelUp}}disabled{{/unless}}>
                                {{#if canAffordLevelUp}}ç¡®è®¤å‡çº§{{else}}èµ„æºä¸è¶³{{/if}}
                            </button>
                        </div>
                    </div>
                    {{else}}
                    <div class="max-level-notice">
                        <div class="max-level-icon">ğŸ‘‘</div>
                        <div class="max-level-text">å·¥åŠå·²è¾¾åˆ°æœ€é«˜ç­‰çº§</div>
                        <div class="max-level-desc">ä½ çš„å·¥åŠå·²ç»æ˜¯æœ€é¡¶çº§çš„åˆæˆè®¾æ–½äº†ï¼</div>
                    </div>
                    {{/if}}
                </div>
                
                <!-- ç‰¹æ€§å‡çº§ -->
                <div class="upgrade-section feature-upgrade">
                    <div class="feature-upgrades">
                        {{#each upgradeableFeatures}}
                        <div class="feature-upgrade-card">
                            <div class="feature-header">
                                <div class="feature-icon">{{icon}}</div>
                                <div class="feature-details">
                                    <div class="feature-name">{{name}}</div>
                                    <div class="feature-current-level">å½“å‰ç­‰çº§: {{currentLevel}}</div>
                                </div>
                                <div class="feature-max-level">æœ€é«˜ Lv.{{maxLevel}}</div>
                            </div>
                            
                            <div class="feature-description">{{description}}</div>
                            
                            <div class="feature-progress">
                                <div class="progress-bar">
                                    <div class="progress-fill" style="width: {{progressPercent}}%"></div>
                                </div>
                                <div class="progress-text">{{currentLevel}}/{{maxLevel}}</div>
                            </div>
                            
                            <div class="feature-benefits">
                                <div class="benefit-current">
                                    <span class="benefit-label">å½“å‰æ•ˆæœ:</span>
                                    <span class="benefit-value">{{currentEffect}}</span>
                                </div>
                                <div class="benefit-next">
                                    <span class="benefit-label">ä¸‹çº§æ•ˆæœ:</span>
                                    <span class="benefit-value">{{nextEffect}}</span>
                                </div>
                            </div>
                            
                            <div class="feature-cost">
                                {{#each upgradeCost}}
                                <div class="cost-item {{#unless canAfford}}insufficient{{/unless}}">
                                    <span class="cost-icon">{{icon}}</span>
                                    <span class="cost-amount">{{amount}}</span>
                                </div>
                                {{/each}}
                            </div>
                            
                            <button class="feature-upgrade-btn" {{#unless canUpgrade}}disabled{{/unless}}>
                                {{#if canUpgrade}}å‡çº§ç‰¹æ€§{{else}}{{#if isMaxLevel}}å·²æ»¡çº§{{else}}èµ„æºä¸è¶³{{/if}}{{/if}}
                            </button>
                        </div>
                        {{/each}}
                    </div>
                </div>
                
                <!-- å·¥åŠæ‰©å»º -->
                <div class="upgrade-section expansion-upgrade">
                    <div class="expansion-options">
                        {{#each expansionOptions}}
                        <div class="expansion-card {{#if owned}}owned{{/if}}">
                            <div class="expansion-image">
                                <img src="{{image}}" alt="{{name}}">
                                {{#if owned}}
                                <div class="owned-badge">å·²æ‹¥æœ‰</div>
                                {{/if}}
                            </div>
                            
                            <div class="expansion-info">
                                <div class="expansion-name">{{name}}</div>
                                <div class="expansion-desc">{{description}}</div>
                                
                                <div class="expansion-benefits">
                                    <div class="benefits-title">æ‰©å»ºæ•ˆæœ:</div>
                                    <div class="benefits-list">
                                        {{#each benefits}}
                                        <div class="benefit-item">
                                            <span class="benefit-icon">{{icon}}</span>
                                            <span class="benefit-text">{{text}}</span>
                                        </div>
                                        {{/each}}
                                    </div>
                                </div>
                                
                                {{#unless owned}}
                                <div class="expansion-requirements">
                                    <div class="requirements-title">å»ºé€ è¦æ±‚:</div>
                                    <div class="requirements-list">
                                        {{#each requirements}}
                                        <div class="requirement-item {{#if met}}met{{else}}unmet{{/if}}">
                                            {{#if met}}âœ…{{else}}âŒ{{/if}} {{text}}
                                        </div>
                                        {{/each}}
                                    </div>
                                </div>
                                
                                <div class="expansion-cost">
                                    {{#each cost}}
                                    <div class="cost-item {{#unless canAfford}}insufficient{{/unless}}">
                                        <span class="cost-icon">{{icon}}</span>
                                        <span class="cost-amount">{{amount}}</span>
                                        <span class="cost-type">{{type}}</span>
                                    </div>
                                    {{/each}}
                                </div>
                                
                                <button class="expansion-btn" {{#unless canBuild}}disabled{{/unless}}>
                                    {{#if canBuild}}å¼€å§‹å»ºé€ {{else}}æ¡ä»¶ä¸è¶³{{/if}}
                                </button>
                                {{/unless}}
                            </div>
                        </div>
                        {{/each}}
                    </div>
                </div>
            </div>
        </div>

        <div class="upgrade-history">
            <div class="history-header">
                <div class="history-title">ğŸ“š å‡çº§å†å²</div>
                <div class="history-stats">
                    <div class="stat-card">
                        <div class="stat-number">{{totalUpgrades}}</div>
                        <div class="stat-label">æ€»å‡çº§æ¬¡æ•°</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number">{{totalInvestment}}</div>
                        <div class="stat-label">æ€»æŠ•èµ„é‡‘é¢</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number">{{efficiencyGain}}%</div>
                        <div class="stat-label">æ•ˆç‡æå‡</div>
                    </div>
                </div>
            </div>
            
            <div class="history-timeline">
                {{#each upgradeHistory}}
                <div class="timeline-item {{type}}">
                    <div class="timeline-icon">{{icon}}</div>
                    <div class="timeline-content">
                        <div class="timeline-title">{{title}}</div>
                        <div class="timeline-desc">{{description}}</div>
                        <div class="timeline-time">{{time}}</div>
                    </div>
                    <div class="timeline-cost">
                        {{#each cost}}
                        <span class="cost-item">
                            {{icon}} {{amount}}
                        </span>
                        {{/each}}
                    </div>
                </div>
                {{/each}}
            </div>
        </div>

        <div class="upgrade-tips">
            <div class="tips-title">ğŸ’¡ å‡çº§å»ºè®®</div>
            <div class="tips-content">
                <div class="tip-category">
                    <div class="category-title">ğŸ¯ ä¼˜å…ˆå‡çº§</div>
                    <div class="tips-list">
                        {{#each priorityTips}}
                        <div class="tip-item priority">
                            <span class="tip-icon">{{icon}}</span>
                            <span class="tip-text">{{text}}</span>
                        </div>
                        {{/each}}
                    </div>
                </div>
                
                <div class="tip-category">
                    <div class="category-title">ğŸ’° æ€§ä»·æ¯”æ¨è</div>
                    <div class="tips-list">
                        {{#each costEffectiveTips}}
                        <div class="tip-item cost-effective">
                            <span class="tip-icon">{{icon}}</span>
                            <span class="tip-text">{{text}}</span>
                        </div>
                        {{/each}}
                    </div>
                </div>
                
                <div class="tip-category">
                    <div class="category-title">âš ï¸ æ³¨æ„äº‹é¡¹</div>
                    <div class="tips-list">
                        {{#each warningTips}}
                        <div class="tip-item warning">
                            <span class="tip-icon">{{icon}}</span>
                            <span class="tip-text">{{text}}</span>
                        </div>
                        {{/each}}
                    </div>
                </div>
            </div>
        </div>
        
        <div class="footer">
            <div class="footer-info">
                <div class="info-text">ğŸ”§ æŒç»­å‡çº§å·¥åŠï¼Œè§£é”æ›´å¤šåˆæˆå¯èƒ½æ€§</div>
                <div class="update-time">æœ€åæ›´æ–°: {{updateTime}}</div>
            </div>
        </div>
    </div>
</body>
</html>