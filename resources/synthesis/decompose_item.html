<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç‰©å“åˆ†è§£ </title>
    <link rel="stylesheet" href="./decompose_item.css">
</head>
<body>
    <div class="container">
        
        <div class="header">
            <div class="decompose-logo">ğŸ”¨</div>
            <h1 class="title">ç‰©å“åˆ†è§£å·¥åŠ</h1>
            <p class="subtitle">å›æ”¶åˆ©ç”¨ï¼Œå˜åºŸä¸ºå®</p>
        </div>

        
        <div class="user-info">
            <div class="user-profile">
                <img src="{{userAvatar}}" alt="ç”¨æˆ·å¤´åƒ" class="user-avatar">
                <div class="user-details">
                    <div class="user-name">{{userName}}</div>
                    <div class="user-level">åˆ†è§£å¸ˆç­‰çº§ {{decomposeLevel}}</div>
                    <div class="user-exp">ç»éªŒå€¼: {{currentExp}}/{{maxExp}}</div>
                </div>
            </div>
            <div class="user-stats">
                <div class="stat-item">
                    <span class="stat-icon">ğŸ”§</span>
                    <div class="stat-info">
                        <div class="stat-label">åˆ†è§£æ¬¡æ•°</div>
                        <div class="stat-value">{{totalDecomposes}}</div>
                    </div>
                </div>
                <div class="stat-item">
                    <span class="stat-icon">ğŸ’</span>
                    <div class="stat-info">
                        <div class="stat-label">å›æ”¶ä»·å€¼</div>
                        <div class="stat-value">{{totalValue}}</div>
                    </div>
                </div>
                <div class="stat-item">
                    <span class="stat-icon">â­</span>
                    <div class="stat-info">
                        <div class="stat-label">æˆåŠŸç‡</div>
                        <div class="stat-value">{{successRate}}%</div>
                    </div>
                </div>
            </div>
        </div>

        
        <div class="item-selection">
            <div class="selection-header">
                <h2 class="selection-title">é€‰æ‹©åˆ†è§£ç‰©å“</h2>
                <div class="selection-filters">
                    <select class="filter-category">
                        <option value="all">å…¨éƒ¨åˆ†ç±»</option>
                        <option value="weapon">æ­¦å™¨</option>
                        <option value="armor">é˜²å…·</option>
                        <option value="accessory">é¥°å“</option>
                        <option value="material">ææ–™</option>
                        <option value="consumable">æ¶ˆè€—å“</option>
                    </select>
                    <select class="filter-rarity">
                        <option value="all">å…¨éƒ¨ç¨€æœ‰åº¦</option>
                        <option value="common">æ™®é€š</option>
                        <option value="uncommon">ä¼˜ç§€</option>
                        <option value="rare">ç¨€æœ‰</option>
                        <option value="epic">å²è¯—</option>
                        <option value="legendary">ä¼ è¯´</option>
                    </select>
                    <select class="filter-condition">
                        <option value="all">å…¨éƒ¨çŠ¶æ€</option>
                        <option value="broken">æŸå</option>
                        <option value="worn">ç£¨æŸ</option>
                        <option value="normal">æ­£å¸¸</option>
                    </select>
                    <input type="text" class="search-item" placeholder="æœç´¢ç‰©å“...">
                </div>
            </div>

            <div class="inventory-grid">
                {{#each inventoryItems}}
                <div class="item-card {{rarity}} {{#if selected}}selected{{/if}} {{#unless canDecompose}}disabled{{/unless}}" 
                     data-item-id="{{id}}" data-category="{{category}}" data-rarity="{{rarity}}" data-condition="{{condition}}">
                    <div class="item-image">
                        <img src="{{image}}" alt="{{name}}">
                        <div class="item-quantity">{{quantity}}</div>
                        {{#if isEquipped}}
                        <div class="equipped-badge">å·²è£…å¤‡</div>
                        {{/if}}
                        {{#unless canDecompose}}
                        <div class="locked-badge">ğŸ”’</div>
                        {{/unless}}
                    </div>
                    <div class="item-info">
                        <div class="item-name">{{name}}</div>
                        <div class="item-level">ç­‰çº§ {{level}}</div>
                        <div class="item-condition {{condition}}">{{conditionText}}</div>
                    </div>
                    <div class="item-value">
                        <div class="decompose-value">åˆ†è§£ä»·å€¼: {{decomposeValue}}</div>
                        <div class="success-chance">æˆåŠŸç‡: {{successChance}}%</div>
                    </div>
                    <div class="item-materials">
                        <div class="materials-title">å¯èƒ½è·å¾—:</div>
                        <div class="materials-list">
                            {{#each possibleMaterials}}
                            <div class="material-item">
                                <img src="{{icon}}" alt="{{name}}" class="material-icon">
                                <span class="material-chance">{{chance}}%</span>
                            </div>
                            {{/each}}
                        </div>
                    </div>
                    {{#if canDecompose}}
                    <div class="item-actions">
                        <button class="select-btn" data-action="toggle-select">{{#if selected}}å–æ¶ˆé€‰æ‹©{{else}}é€‰æ‹©{{/if}}</button>
                    </div>
                    {{/if}}
                </div>
                {{/each}}
            </div>
        </div>

       
        <div class="decompose-preview">
            <div class="preview-header">
                <h3 class="preview-title">åˆ†è§£é¢„è§ˆ</h3>
                <div class="preview-stats">
                    <div class="stat-item">
                        <span class="stat-label">é€‰ä¸­ç‰©å“:</span>
                        <span class="stat-value">{{selectedCount}}</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">é¢„è®¡ä»·å€¼:</span>
                        <span class="stat-value">{{estimatedValue}}</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">å¹³å‡æˆåŠŸç‡:</span>
                        <span class="stat-value">{{averageSuccessRate}}%</span>
                    </div>
                </div>
            </div>

            {{#if selectedItems.length}}
            <div class="selected-items">
                <div class="items-list">
                    {{#each selectedItems}}
                    <div class="selected-item">
                        <div class="item-image">
                            <img src="{{image}}" alt="{{name}}">
                        </div>
                        <div class="item-details">
                            <div class="item-name">{{name}}</div>
                            <div class="item-info">ç­‰çº§ {{level}} | {{conditionText}}</div>
                        </div>
                        <div class="item-value">{{decomposeValue}}</div>
                        <div class="item-chance">{{successChance}}%</div>
                        <button class="remove-btn" data-item-id="{{id}}">ç§»é™¤</button>
                    </div>
                    {{/each}}
                </div>
            </div>

            <div class="expected-materials">
                <div class="materials-header">
                    <h4 class="materials-title">é¢„æœŸè·å¾—ææ–™</h4>
                </div>
                <div class="materials-grid">
                    {{#each expectedMaterials}}
                    <div class="material-card">
                        <div class="material-image">
                            <img src="{{icon}}" alt="{{name}}">
                        </div>
                        <div class="material-info">
                            <div class="material-name">{{name}}</div>
                            <div class="material-amount">é¢„æœŸ: {{expectedAmount}}</div>
                            <div class="material-chance">æ¦‚ç‡: {{totalChance}}%</div>
                        </div>
                    </div>
                    {{/each}}
                </div>
            </div>
            {{else}}
            <div class="empty-selection">
                <div class="empty-icon">ğŸ“¦</div>
                <div class="empty-text">æœªé€‰æ‹©ä»»ä½•ç‰©å“</div>
                <div class="empty-desc">è¯·ä»ä¸Šæ–¹é€‰æ‹©è¦åˆ†è§£çš„ç‰©å“</div>
            </div>
            {{/if}}
        </div>

        
        <div class="decompose-settings">
            <div class="settings-header">
                <h3 class="settings-title">åˆ†è§£è®¾ç½®</h3>
            </div>

            <div class="settings-content">
                <div class="setting-group">
                    <label class="setting-label">åˆ†è§£æ¨¡å¼</label>
                    <div class="mode-options">
                        <label class="mode-option">
                            <input type="radio" name="decomposeMode" value="normal" checked>
                            <span class="mode-text">æ™®é€šåˆ†è§£</span>
                            <span class="mode-desc">æ ‡å‡†åˆ†è§£ï¼Œå¹³è¡¡é£é™©ä¸æ”¶ç›Š</span>
                        </label>
                        <label class="mode-option">
                            <input type="radio" name="decomposeMode" value="careful">
                            <span class="mode-text">è°¨æ…åˆ†è§£</span>
                            <span class="mode-desc">æé«˜æˆåŠŸç‡ï¼Œé™ä½ææ–™è·å¾—é‡</span>
                        </label>
                        <label class="mode-option">
                            <input type="radio" name="decomposeMode" value="aggressive">
                            <span class="mode-text">æ¿€è¿›åˆ†è§£</span>
                            <span class="mode-desc">æé«˜ææ–™è·å¾—é‡ï¼Œé™ä½æˆåŠŸç‡</span>
                        </label>
                    </div>
                </div>

                <div class="setting-group">
                    <label class="setting-label">ä½¿ç”¨å¢ç›Šé“å…·</label>
                    <div class="boost-items">
                        {{#each availableBoosts}}
                        <div class="boost-item {{#unless available}}unavailable{{/unless}}">
                            <label class="boost-option">
                                <input type="checkbox" name="useBoost" value="{{id}}" {{#unless available}}disabled{{/unless}}>
                                <img src="{{icon}}" alt="{{name}}" class="boost-icon">
                                <div class="boost-info">
                                    <div class="boost-name">{{name}}</div>
                                    <div class="boost-effect">{{effect}}</div>
                                    <div class="boost-count">æ‹¥æœ‰: {{count}}</div>
                                </div>
                            </label>
                        </div>
                        {{/each}}
                    </div>
                </div>

                <div class="setting-group">
                    <label class="setting-label">è‡ªåŠ¨å¤„ç†</label>
                    <div class="auto-options">
                        <label class="auto-option">
                            <input type="checkbox" name="autoSell" value="true">
                            <span class="auto-text">è‡ªåŠ¨å‡ºå”®ä½ä»·å€¼ææ–™</span>
                        </label>
                        <label class="auto-option">
                            <input type="checkbox" name="autoStore" value="true">
                            <span class="auto-text">è‡ªåŠ¨å­˜å‚¨ç¨€æœ‰ææ–™</span>
                        </label>
                        <label class="auto-option">
                            <input type="checkbox" name="autoRepeat" value="true">
                            <span class="auto-text">å¤±è´¥åè‡ªåŠ¨é‡è¯•</span>
                        </label>
                    </div>
                </div>
            </div>
        </div>

        <!-- æ‰§è¡Œæ§åˆ¶ -->
        <div class="execution-control">
            <div class="control-header">
                <h3 class="control-title">æ‰§è¡Œåˆ†è§£</h3>
                <div class="safety-warning">
                    <span class="warning-icon">âš ï¸</span>
                    <span class="warning-text">åˆ†è§£åçš„ç‰©å“æ— æ³•æ¢å¤ï¼Œè¯·è°¨æ…æ“ä½œ</span>
                </div>
            </div>

            <div class="control-summary">
                <div class="summary-item">
                    <div class="summary-label">åˆ†è§£ç‰©å“æ•°é‡</div>
                    <div class="summary-value">{{selectedCount}} ä»¶</div>
                </div>
                <div class="summary-item">
                    <div class="summary-label">é¢„è®¡è·å¾—ä»·å€¼</div>
                    <div class="summary-value">{{estimatedValue}}</div>
                </div>
                <div class="summary-item">
                    <div class="summary-label">æ€»ä½“æˆåŠŸç‡</div>
                    <div class="summary-value">{{overallSuccessRate}}%</div>
                </div>
                <div class="summary-item">
                    <div class="summary-label">é¢„è®¡è€—æ—¶</div>
                    <div class="summary-value">{{estimatedTime}}</div>
                </div>
            </div>

            <div class="control-actions">
                <button class="preview-btn" {{#unless selectedCount}}disabled{{/unless}}>ğŸ‘ï¸ è¯¦ç»†é¢„è§ˆ</button>
                <button class="decompose-btn" {{#unless selectedCount}}disabled{{/unless}}>ğŸ”¨ å¼€å§‹åˆ†è§£</button>
                <button class="batch-select-btn">ğŸ“‹ æ‰¹é‡é€‰æ‹©</button>
                <button class="clear-btn">ğŸ—‘ï¸ æ¸…ç©ºé€‰æ‹©</button>
            </div>
        </div>

      
        {{#if decomposeResults}}
        <div class="decompose-results">
            <div class="results-header">
                <h3 class="results-title">åˆ†è§£ç»“æœ</h3>
                <div class="results-summary">
                    <div class="summary-stat success">
                        <span class="stat-number">{{successCount}}</span>
                        <span class="stat-label">æˆåŠŸ</span>
                    </div>
                    <div class="summary-stat failure">
                        <span class="stat-number">{{failureCount}}</span>
                        <span class="stat-label">å¤±è´¥</span>
                    </div>
                    <div class="summary-stat total">
                        <span class="stat-number">{{totalValue}}</span>
                        <span class="stat-label">æ€»ä»·å€¼</span>
                    </div>
                </div>
            </div>

            <div class="results-content">
                <div class="obtained-materials">
                    <h4 class="materials-title">è·å¾—çš„ææ–™</h4>
                    <div class="materials-grid">
                        {{#each obtainedMaterials}}
                        <div class="material-result">
                            <div class="material-image">
                                <img src="{{icon}}" alt="{{name}}">
                                <div class="material-count">{{amount}}</div>
                            </div>
                            <div class="material-info">
                                <div class="material-name">{{name}}</div>
                                <div class="material-value">ä»·å€¼: {{value}}</div>
                            </div>
                        </div>
                        {{/each}}
                    </div>
                </div>

                <div class="decompose-log">
                    <h4 class="log-title">åˆ†è§£è®°å½•</h4>
                    <div class="log-list">
                        {{#each decomposeLog}}
                        <div class="log-item {{result}}">
                            <div class="log-icon">{{#if success}}âœ…{{else}}âŒ{{/if}}</div>
                            <div class="log-content">
                                <div class="log-item-name">{{itemName}}</div>
                                <div class="log-result">{{resultText}}</div>
                            </div>
                            <div class="log-value">{{value}}</div>
                        </div>
                        {{/each}}
                    </div>
                </div>
            </div>

            <div class="results-actions">
                <button class="continue-btn">ğŸ”„ ç»§ç»­åˆ†è§£</button>
                <button class="save-materials-btn">ğŸ’¾ ä¿å­˜ææ–™</button>
                <button class="share-results-btn">ğŸ“¤ åˆ†äº«ç»“æœ</button>
            </div>
        </div>
        {{/if}}

        <!-- åˆ†è§£å†å² -->
        <div class="decompose-history">
            <div class="history-header">
                <h3 class="history-title">æœ€è¿‘åˆ†è§£è®°å½•</h3>
                <button class="view-all-btn">æŸ¥çœ‹å…¨éƒ¨è®°å½•</button>
            </div>

            <div class="history-list">
                {{#each recentDecomposes}}
                <div class="history-item">
                    <div class="history-time">{{time}}</div>
                    <div class="history-summary">
                        <div class="summary-text">åˆ†è§£äº† {{itemCount}} ä»¶ç‰©å“</div>
                        <div class="summary-stats">
                            <span class="success-rate">æˆåŠŸç‡: {{successRate}}%</span>
                            <span class="total-value">è·å¾—ä»·å€¼: {{totalValue}}</span>
                        </div>
                    </div>
                    <div class="history-actions">
                        <button class="details-btn">ğŸ“‹ æŸ¥çœ‹è¯¦æƒ…</button>
                    </div>
                </div>
                {{/each}}
            </div>
        </div>

        <!-- é¡µè„š -->
        <div class="footer">
            <div class="footer-info">
                <p class="info-text">åˆç†åˆ†è§£ç‰©å“å¯ä»¥è·å¾—çè´µææ–™ï¼Œæå‡åˆ†è§£æŠ€èƒ½ç­‰çº§å¯ä»¥æé«˜æˆåŠŸç‡</p>
                <p class="update-time">æœ€åæ›´æ–°: {{updateTime}}</p>
            </div>
        </div>
    </div>

    <script>
        
        document.addEventListener('DOMContentLoaded', function() {
            const filterCategory = document.querySelector('.filter-category');
            const filterRarity = document.querySelector('.filter-rarity');
            const filterCondition = document.querySelector('.filter-condition');
            const searchInput = document.querySelector('.search-item');
            
            function filterItems() {
                const category = filterCategory.value;
                const rarity = filterRarity.value;
                const condition = filterCondition.value;
                const search = searchInput.value.toLowerCase();
                
                document.querySelectorAll('.item-card').forEach(card => {
                    const cardCategory = card.dataset.category;
                    const cardRarity = card.dataset.rarity;
                    const cardCondition = card.dataset.condition;
                    const cardName = card.querySelector('.item-name').textContent.toLowerCase();
                    
                    const categoryMatch = category === 'all' || cardCategory === category;
                    const rarityMatch = rarity === 'all' || cardRarity === rarity;
                    const conditionMatch = condition === 'all' || cardCondition === condition;
                    const searchMatch = search === '' || cardName.includes(search);
                    
                    card.style.display = categoryMatch && rarityMatch && conditionMatch && searchMatch ? 'block' : 'none';
                });
            }
            
            filterCategory.addEventListener('change', filterItems);
            filterRarity.addEventListener('change', filterItems);
            filterCondition.addEventListener('change', filterItems);
            searchInput.addEventListener('input', filterItems);
            
            document.querySelectorAll('.select-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const itemCard = this.closest('.item-card');
                    const itemId = itemCard.dataset.itemId;
                    
                    itemCard.classList.toggle('selected');
                    this.textContent = itemCard.classList.contains('selected') ? 'å–æ¶ˆé€‰æ‹©' : 'é€‰æ‹©';
                    
                    updatePreview();
                });
            });
            
            
            document.querySelector('.batch-select-btn').addEventListener('click', function() {
                console.log('æ‰¹é‡é€‰æ‹©');
            });
            
            
            document.querySelector('.clear-btn').addEventListener('click', function() {
                document.querySelectorAll('.item-card.selected').forEach(card => {
                    card.classList.remove('selected');
                    const btn = card.querySelector('.select-btn');
                    if (btn) btn.textContent = 'é€‰æ‹©';
                });
                updatePreview();
            });
            
           
            document.querySelector('.decompose-btn').addEventListener('click', function() {
                console.log('å¼€å§‹åˆ†è§£');
            });
            
            function updatePreview() {
                const selectedItems = document.querySelectorAll('.item-card.selected');
                console.log('æ›´æ–°é¢„è§ˆï¼Œé€‰ä¸­ç‰©å“æ•°é‡:', selectedItems.length);
            }
        });
    </script>
</body>
</html>